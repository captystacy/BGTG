@using Calabonga.OperationResults

@model OperationResult<Calabonga.UnitOfWork.IPagedList<BGTG.Web.ViewModels.ConstructionObjectViewModel>>

@section Scripts {
<script src="~/js/construction-objects.js" asp-append-version="true"></script>
}

<div id="construction-objects">
    @if (Model.Ok)
    {
        @foreach (var constructionObject in Model.Result.Items)
        {
            <partial name="POSPartialViews/_ConstructionObject" model="constructionObject" />
        }
        @if (Model.Result.TotalPages > 1)
        {
            <nav class="mt-3">
                <ul class="pagination justify-content-center">
                    <li class="page-item @(Model.Result.HasPreviousPage ? "" : "disabled")">
                        <a class="page-link" asp-route-PageIndex="@(Model.Result.PageIndex - 1)">
                            <span>&laquo;</span>
                        </a>
                    </li>
                    @if (Model.Result.TotalPages <= 7)
                    {
                        for (int i = 0; i < Model.Result.TotalPages; i++)
                        {
                            <li class="page-item @(Model.Result.PageIndex == i ? "active" : "")">
                                <a class="page-link" asp-route-PageIndex="@i">
                                    @(i + 1)
                                </a>
                            </li>
                        }
                    }
                    else
                    {
                        if (Model.Result.PageIndex <= 3)
                        {
                            var count = Model.Result.TotalPages > 5 ? 5 : Model.Result.TotalPages;
                            for (int i = 0; i < count; i++)
                            {
                                <li class="page-item @(Model.Result.PageIndex == i ? "active" : "")">
                                    <a class="page-link" asp-route-PageIndex="@i">
                                        @(i + 1)
                                    </a>
                                </li>
                            }
                            <li class="page-item disabled">
                                <a class="page-link">
                                    ...
                                </a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" asp-route-PageIndex="@(Model.Result.TotalPages - 1)">
                                    @Model.Result.TotalPages
                                </a>
                            </li>
                        }
                        if (Model.Result.PageIndex > 3 && Model.Result.PageIndex < Model.Result.TotalPages - 4)
                        {
                            <li class="page-item">
                                <a class="page-link" asp-route-PageIndex="0">
                                    1
                                </a>
                            </li>
                            <li class="page-item disabled">
                                <a class="page-link">
                                    ...
                                </a>
                            </li>
                            for (int i = Model.Result.PageIndex - 2; i < Model.Result.PageIndex + 3; i++)
                            {
                                <li class="page-item @(Model.Result.PageIndex == i ? "active" : "")">
                                    <a class="page-link" asp-route-PageIndex="@i">
                                        @(i + 1)
                                    </a>
                                </li>
                            }
                            <li class="page-item disabled">
                                <a class="page-link">
                                    ...
                                </a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" asp-route-PageIndex="@(Model.Result.TotalPages - 1)">
                                    @Model.Result.TotalPages
                                </a>
                            </li>
                        }
                        if (Model.Result.PageIndex > Model.Result.TotalPages - 5)
                        {
                            <li class="page-item">
                                <a class="page-link" asp-route-PageIndex="0">
                                    1
                                </a>
                            </li>
                            <li class="page-item disabled">
                                <a class="page-link">
                                    ...
                                </a>
                            </li>
                            for (int i = Model.Result.TotalPages - 5; i < Model.Result.TotalPages; i++)
                            {
                                <li class="page-item @(Model.Result.PageIndex == i ? "active" : "")">
                                    <a class="page-link" asp-route-PageIndex="@i">
                                        @(i + 1)
                                    </a>
                                </li>
                            }
                        }
                    }
                    <li class="page-item  @(Model.Result.HasNextPage ? "" : "disabled")">
                        <a class="page-link" asp-route-PageIndex="@(Model.Result.PageIndex + 1)">
                            <span>&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        }
    }
    else if (Model.Metadata.Type == MetadataType.Error)
    {
        <div>
            @Model.Metadata.Message
        </div>
    }
</div>